<!DOCTYPE html>
<html lang="en">
<head>
<!-- Auto-generated via Perplexity on 2025-11-01T13:21:10.815879Z -->

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width,initial-scale=1'>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Finance Snapshot</title>
  <style>
    :root {
      --bg: #fff;
      --text: #222;
      --border: #ddd;
      --accent: #4a6fa5;
      --accent-light: #e2e8f0;
      --danger: #e53e3e;
      --success: #38a169;
      --chart-bg: #f8f9fa;
      --chart-text: #333;
    }
    @media (prefers-color-scheme: dark) {
      :root {
        --bg: #1a202c;
        --text: #e2e8f0;
        --border: #2d3748;
        --accent: #63b3ed;
        --accent-light: #2d3748;
        --danger: #fc8181;
        --success: #68d391;
        --chart-bg: #2d3748;
        --chart-text: #e2e8f0;
      }
    }
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, sans-serif;
    }
    body {
      background: var(--bg);
      color: var(--text);
      line-height: 1.5;
      padding: 1rem;
      max-width: 1000px;
      margin: 0 auto;
    }
    h1 {
      font-size: 1.5rem;
      margin-bottom: 1rem;
      color: var(--accent);
    }
    .grid {
      display: grid;
      gap: 1rem;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    }
    section {
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: 0.5rem;
      padding: 1rem;
      margin-bottom: 1rem;
    }
    .form-grid {
      display: grid;
      gap: 0.5rem;
      grid-template-columns: 1fr 1fr;
    }
    label {
      display: block;
      margin-bottom: 0.25rem;
      font-weight: 500;
    }
    input, select, button {
      width: 100%;
      padding: 0.5rem;
      border: 1px solid var(--border);
      border-radius: 0.25rem;
      background: var(--bg);
      color: var(--text);
    }
    button {
      background: var(--accent);
      color: white;
      border: none;
      cursor: pointer;
      font-weight: 500;
      transition: background 0.2s;
    }
    button:hover {
      background: #3a7bd5;
    }
    button.danger {
      background: var(--danger);
    }
    button.success {
      background: var(--success);
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
    }
    th, td {
      padding: 0.5rem;
      text-align: left;
      border-bottom: 1px solid var(--border);
    }
    th {
      background: var(--accent-light);
      font-weight: 600;
    }
    tr:hover {
      background: var(--accent-light);
    }
    .chart-container {
      margin-top: 1rem;
      background: var(--chart-bg);
      border-radius: 0.5rem;
      padding: 1rem;
      color: var(--chart-text);
    }
    canvas {
      width: 100%;
      max-height: 300px;
    }
    .mobile-collapse {
      display: block;
    }
    @media (max-width: 600px) {
      .mobile-collapse {
        display: none;
      }
      .mobile-collapse.show {
        display: block;
      }
    }
    .toggle-charts {
      display: none;
    }
    @media (max-width: 600px) {
      .toggle-charts {
        display: block;
        margin: 1rem 0;
      }
    }
    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      border: 0;
    }
    .category-edit {
      display: flex;
      gap: 0.5rem;
      margin-top: 0.5rem;
    }
    .category-edit input {
      flex: 1;
    }
    .error {
      color: var(--danger);
      font-size: 0.875rem;
      margin-top: 0.25rem;
    }
    .actions {
      display: flex;
      gap: 0.5rem;
    }
    .actions button {
      flex: 1;
    }
    a {
      color: var(--accent);
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <h1>Finance Snapshot</h1>
  <div class="grid">
    <section aria-labelledby="form-heading">
      <h2 id="form-heading">Add Transaction</h2>
      <form id="transaction-form" class="form-grid">
        <div>
          <label for="date">Date</label>
          <input type="date" id="date" required aria-required="true">
        </div>
        <div>
          <label for="amount">Amount</label>
          <input type="number" id="amount" step="0.01" required aria-required="true" placeholder="0.00">
        </div>
        <div>
          <label for="type">Type</label>
          <select id="type" required aria-required="true">
            <option value="income">Income (+)</option>
            <option value="expense">Expense (-)</option>
          </select>
        </div>
        <div>
          <label for="category">Category</label>
          <div class="category-edit">
            <select id="category" required aria-required="true"></select>
            <button type="button" id="add-category" aria-label="Add new category">+</button>
          </div>
        </div>
        <div>
          <label for="note">Note (optional)</label>
          <input type="text" id="note" placeholder="Optional description">
        </div>
        <div class="actions">
          <button type="submit" id="submit">Add</button>
          <button type="button" id="clear">Clear</button>
        </div>
      </form>
      <div id="form-error" class="error" role="alert" aria-live="assertive"></div>
    </section>
    <section aria-labelledby="table-heading">
      <h2 id="table-heading">Transactions</h2>
      <div class="table-responsive">
        <table id="transactions-table">
          <thead>
            <tr>
              <th><button type="button" id="sort-date">Date</button></th>
              <th><button type="button" id="sort-category">Category</button></th>
              <th>Amount</th>
              <th>Note</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="transactions-body"></tbody>
        </table>
      </div>
    </section>
  </div>
  <button class="toggle-charts" id="toggle-charts">Show/Hide Charts</button>
  <section class="mobile-collapse" id="charts-section" aria-labelledby="charts-heading">
    <h2 id="charts-heading">Charts</h2>
    <div class="chart-container">
      <h3>Spending by Category</h3>
      <canvas id="pie-chart" width="400" height="300" aria-label="Pie chart of spending by category"></canvas>
    </div>
    <div class="chart-container">
      <h3>Daily Net Amount</h3>
      <canvas id="bar-chart" width="400" height="300" aria-label="Bar chart of daily net amounts"></canvas>
    </div>
  </section>
  <section aria-labelledby="share-heading">
    <h2 id="share-heading">Share Snapshot</h2>
    <div class="form-grid">
      <div>
        <label for="share-url">Shareable URL</label>
        <input type="text" id="share-url" readonly aria-readonly="true">
      </div>
      <div>
        <button type="button" id="copy-url">Copy URL</button>
        <button type="button" id="load-url">Load from URL</button>
      </div>
    </div>
  </section>
  <script>
    // Data persistence and initialization
    const STORAGE_KEY = 'financeSnapshot';
    const CATEGORIES_KEY = 'financeCategories';
    let transactions = [];
    let categories = ['Food', 'Transport', 'Shopping', 'Bills', 'Salary', 'Other'];
    let sortBy = 'date';
    let sortAsc = true;

    function loadData() {
      const saved = localStorage.getItem(STORAGE_KEY);
      transactions = saved ? JSON.parse(saved) : [];
      const savedCats = localStorage.getItem(CATEGORIES_KEY);
      categories = savedCats ? JSON.parse(savedCats) : categories;
      updateCategorySelect();
      renderTransactions();
      updateCharts();
      updateShareUrl();
    }

    function saveData() {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(transactions));
      localStorage.setItem(CATEGORIES_KEY, JSON.stringify(categories));
      updateShareUrl();
    }

    // Form handling
    const form = document.getElementById('transaction-form');
    const dateInput = document.getElementById('date');
    const amountInput = document.getElementById('amount');
    const typeInput = document.getElementById('type');
    const categoryInput = document.getElementById('category');
    const noteInput = document.getElementById('note');
    const formError = document.getElementById('form-error');
    const clearBtn = document.getElementById('clear');
    const addCategoryBtn = document.getElementById('add-category');

    // Set today's date as default
    dateInput.valueAsDate = new Date();

    function updateCategorySelect() {
      categoryInput.innerHTML = categories.map(cat => `<option value="${cat}">${cat}</option>`).join('');
    }

    form.addEventListener('submit', e => {
      e.preventDefault();
      const amount = parseFloat(amountInput.value);
      if (isNaN(amount)) {
        formError.textContent = 'Amount must be a valid number';
        amountInput.focus();
        return;
      }
      formError.textContent = '';
      const transaction = {
        id: Date.now().toString(),
        date: dateInput.value,
        amount: typeInput.value === 'income' ? Math.abs(amount) : -Math.abs(amount),
        type: typeInput.value,
        category: categoryInput.value,
        note: noteInput.value
      };
      transactions.push(transaction);
      saveData();
      renderTransactions();
      updateCharts();
      form.reset();
      dateInput.valueAsDate = new Date();
      amountInput.focus();
    });

    clearBtn.addEventListener('click', () => {
      form.reset();
      dateInput.valueAsDate = new Date();
      amountInput.focus();
    });

    addCategoryBtn.addEventListener('click', () => {
      const newCat = prompt('Enter new category name:');
      if (newCat && !categories.includes(newCat)) {
        categories.push(newCat);
        updateCategorySelect();
        categoryInput.value = newCat;
        saveData();
      }
    });

    // Table rendering and sorting
    const tableBody = document.getElementById('transactions-body');
    const sortDateBtn = document.getElementById('sort-date');
    const sortCategoryBtn = document.getElementById('sort-category');

    function renderTransactions() {
      let sorted = [...transactions];
      sorted.sort((a, b) => {
        if (sortBy === 'date') {
          return sortAsc ? a.date.localeCompare(b.date) : b.date.localeCompare(a.date);
        } else {
          return sortAsc ? a.category.localeCompare(b.category) : b.category.localeCompare(a.category);
        }
      });
      tableBody.innerHTML = sorted.map(t => `
        <tr data-id="${t.id}" tabindex="0">
          <td>${t.date}</td>
          <td>
            <span class="category-value">${t.category}</span>
            <select class="category-edit-select" style="display:none;">
              ${categories.map(c => `<option value="${c}" ${c === t.category ? 'selected' : ''}>${c}</option>`).join('')}
            </select>
          </td>
          <td class="amount ${t.type}">${t.type === 'income' ? '+' : '-'}${Math.abs(t.amount).toFixed(2)}</td>
          <td>${t.note || ''}</td>
          <td>
            <button class="edit" aria-label="Edit">✏️</button>
            <button class="delete danger" aria-label="Delete">🗑️</button>
          </td>
        </tr>
      `).join('');
      // Add event listeners for edit, delete, and inline category edit
      document.querySelectorAll('.edit').forEach(btn => {
        btn.addEventListener('click', e => {
          const row = e.target.closest('tr');
          const id = row.dataset.id;
          const t = transactions.find(t => t.id === id);
          dateInput.value = t.date;
          amountInput.value = Math.abs(t.amount).toFixed(2);
          typeInput.value = t.type;
          categoryInput.value = t.category;
          noteInput.value = t.note || '';
          transactions = transactions.filter(t => t.id !== id);
          saveData();
          renderTransactions();
          updateCharts();
          dateInput.focus();
        });
      });
      document.querySelectorAll('.delete').forEach(btn => {
        btn.addEventListener('click', e => {
          const id = e.target.closest('tr').dataset.id;
          transactions = transactions.filter(t => t.id !== id);
          saveData();
          renderTransactions();
          updateCharts();
        });
      });
      document.querySelectorAll('tr[data-id]').forEach(row => {
        row.addEventListener('keydown', e => {
          if (e.key === 'Delete') {
            const id = row.dataset.id;
            transactions = transactions.filter(t => t.id !== id);
            saveData();
            renderTransactions();
            updateCharts();
          }
        });
        row.addEventListener('dblclick', () => {
          const span = row.querySelector('.category-value');
          const select = row.querySelector('.category-edit-select');
          span.style.display = 'none';
          select.style.display = 'inline-block';
          select.focus();
          select.addEventListener('change', () => {
            const id = row.dataset.id;
            const t = transactions.find(t => t.id === id);
            t.category = select.value;
            saveData();
            renderTransactions();
            updateCharts();
          });
          select.addEventListener('blur', () => {
            span.style.display = 'inline';
            select.style.display = 'none';
          });
        });
      });
    }

    sortDateBtn.addEventListener('click', () => {
      if (sortBy === 'date') sortAsc = !sortAsc;
      else { sortBy = 'date'; sortAsc = true; }
      renderTransactions();
    });

    sortCategoryBtn.addEventListener('click', () => {
      if (sortBy === 'category') sortAsc = !sortAsc;
      else { sortBy = 'category'; sortAsc = true; }
      renderTransactions();
    });

    // Charts
    const pieCtx = document.getElementById('pie-chart').getContext('2d');
    const barCtx = document.getElementById('bar-chart').getContext('2d');
    let pieChart, barChart;

    function updateCharts() {
      // Destroy previous charts if they exist
      if (pieChart) pieChart.destroy();
      if (barChart) barChart.destroy();

      // Pie chart: Spending by category (expenses only)
      const expensesByCat = {};
      transactions.filter(t => t.type === 'expense').forEach(t => {
        expensesByCat[t.category] = (expensesByCat[t.category] || 0) + Math.abs(t.amount);
      });
      const pieData = {
        labels: Object.keys(expensesByCat),
        datasets: [{
          data: Object.values(expensesByCat),
          backgroundColor: [
            '#4e79a7', '#f28e2b', '#e15759', '#76b7b2', '#59a14f', '#edc948', '#b07aa1', '#ff9da7', '#9c755f', '#bab0ac'
          ]
        }]
      };
      pieChart = new Chart(pieCtx, {
        type: 'pie',
        data: pieData,
        options: { responsive: true, maintainAspectRatio: false }
      });

      // Bar chart: Daily net amount
      const dailyNet = {};
      transactions.forEach(t => {
        dailyNet[t.date] = (dailyNet[t.date] || 0) + t.amount;
      });
      const sortedDates = Object.keys(dailyNet).sort();
      const barData = {
        labels: sortedDates,
        datasets: [{
          label: 'Daily Net',
          data: sortedDates.map(d => dailyNet[d]),
          backgroundColor: sortedDates.map(d => dailyNet[d] >= 0 ? 'rgba(56, 161, 105, 0.7)' : 'rgba(229, 62, 62, 0.7)')
        }]
      };
      barChart = new Chart(barCtx, {
        type: 'bar',
        data: barData,
        options: { responsive: true, maintainAspectRatio: false }
      });
    }

    // Mobile chart toggling
    const toggleChartsBtn = document.getElementById('toggle-charts');
    const chartsSection = document.getElementById('charts-section');
    toggleChartsBtn.addEventListener('click', () => {
      chartsSection.classList.toggle('show');
    });

    // Share via URL hash
    const shareUrlInput = document.getElementById('share-url');
    const copyUrlBtn = document.getElementById('copy-url');
    const loadUrlBtn = document.getElementById('load-url');

    function updateShareUrl() {
      const data = { transactions, categories };
      const json = JSON.stringify(data);
      // Simple compression: base64 encode the URI component
      const compressed = btoa(encodeURIComponent(json));
      shareUrlInput.value = window.location.href.split('#') + '#' + compressed;
    }

    copyUrlBtn.addEventListener('click', () => {
      shareUrlInput.select();
      document.execCommand('copy');
      shareUrlInput.blur();
      alert('URL copied to clipboard!');
    });

    loadUrlBtn.addEventListener('click', () => {
      const hash = window.location.hash.slice(1);
      if (hash) {
        try {
          const json = decodeURIComponent(atob(hash));
          const data = JSON.parse(json);
          transactions = data.transactions;
          categories = data.categories;
          saveData();
          renderTransactions();
          updateCharts();
          updateCategorySelect();
          alert('Data loaded from URL!');
        } catch (e) {
          alert('Invalid or corrupted URL data.');
        }
      } else {
        alert('No data found in URL.');
      }
    });

    // Check URL hash on load
    window.addEventListener('load', () => {
      loadData();
      if (window.location.hash) {
        loadUrlBtn.click();
      }
    });

    // Keyboard shortcuts
    document.addEventListener('keydown', e => {
      if (e.target.tagName === 'INPUT' || e.target.tagName === 'SELECT' || e.target.tagName === 'BUTTON') return;
      if (e.key === 'Enter') {
        form.dispatchEvent(new Event('submit'));
      }
    });

    // Accessibility: focus management
    form.addEventListener('keydown', e => {
      if (e.key === 'Enter' && e.target.tagName !== 'TEXTAREA') {
        e.preventDefault();
        form.dispatchEvent(new Event('submit'));
      }
    });
  </script>
  
</body>
</html>