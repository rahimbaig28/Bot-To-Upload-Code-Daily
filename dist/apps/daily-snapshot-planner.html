<!DOCTYPE html>
<html lang="en">
<head>
<!-- Auto-generated via Perplexity on 2025-11-10T13:29:24.728561Z -->

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width,initial-scale=1'>

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Daily Snapshot Planner</title>
  <style>
    :root {
      --primary: #4a90e2;
      --bg: #f8f9fa;
      --card-bg: #ffffff;
      --border: #dee2e6;
      --text: #212529;
      --complete: #6c757d;
      --highlight: #e9ecef;
      --shadow: rgba(0, 0, 0, 0.1);
    }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
      margin: 0;
      padding: 1rem;
      background-color: var(--bg);
      color: var(--text);
      line-height: 1.5;
    }
    h1 {
      font-size: 1.5rem;
      margin-bottom: 1rem;
      color: var(--primary);
    }
    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-bottom: 1rem;
      align-items: center;
    }
    input[type="text"] {
      flex: 1;
      min-width: 200px;
      padding: 0.5rem;
      border: 1px solid var(--border);
      border-radius: 4px;
      font-size: 1rem;
    }
    button {
      padding: 0.5rem 1rem;
      background-color: var(--primary);
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 1rem;
    }
    button:hover {
      opacity: 0.9;
    }
    .grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 1rem;
      margin-bottom: 2rem;
    }
    @media (min-width: 600px) {
      .grid {
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      }
    }
    .day {
      background-color: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 4px var(--shadow);
    }
    .day-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.75rem 1rem;
      background-color: var(--highlight);
      cursor: pointer;
      font-weight: bold;
    }
    .day-header .date {
      flex: 1;
    }
    .day-header .toggle {
      font-size: 1.2rem;
    }
    .day-content {
      padding: 1rem;
      display: none;
    }
    .day.expanded .day-content {
      display: block;
    }
    .card {
      background-color: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: 0.75rem;
      margin-bottom: 0.75rem;
      position: relative;
      resize: vertical;
      min-height: 40px;
      overflow: hidden;
    }
    .card.completed {
      opacity: 0.6;
      text-decoration: line-through;
    }
    .card textarea {
      width: 100%;
      min-height: 60px;
      border: none;
      background: transparent;
      resize: none;
      font-family: inherit;
      font-size: 1rem;
      outline: none;
    }
    .card .controls {
      display: flex;
      justify-content: flex-end;
      margin-top: 0.5rem;
    }
    .card .controls button {
      padding: 0.25rem 0.5rem;
      font-size: 0.875rem;
    }
    .card .checkbox {
      position: absolute;
      top: 0.5rem;
      right: 0.5rem;
      cursor: pointer;
    }
    .card .checkbox input {
      margin: 0;
    }
    .card .tag {
      background-color: var(--highlight);
      color: var(--primary);
      padding: 0.2rem 0.4rem;
      border-radius: 4px;
      font-size: 0.8rem;
      margin: 0.2rem 0.2rem 0.2rem 0;
      display: inline-block;
    }
    .print-mode {
      display: none;
    }
    @media print {
      body * {
        visibility: hidden;
      }
      .print-mode, .print-mode * {
        visibility: visible;
      }
      .print-mode {
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
      }
      .day-header .toggle,
      .card .checkbox,
      .card .controls,
      .controls,
      .day-header .actions {
        display: none;
      }
      .day-content {
        display: block !important;
      }
      .card {
        border: none;
        box-shadow: none;
        background: transparent;
      }
      .card textarea {
        background: transparent;
        border: none;
      }
    }
    .print-mode .day {
      margin-bottom: 1rem;
    }
    .print-mode .card {
      margin-bottom: 0.5rem;
    }
    .print-mode .card.completed {
      opacity: 1;
      text-decoration: none;
    }
    .print-mode .card textarea {
      background: transparent;
      border: none;
    }
    .print-mode .card .tag {
      background: none;
      border: 1px solid var(--border);
    }
    .print-mode .day-header {
      background: none;
      border-bottom: 1px solid var(--border);
    }
    .print-mode .day-header .date {
      font-weight: bold;
    }
    .print-mode .card textarea {
      min-height: auto;
    }
    .print-mode .card textarea:focus {
      outline: none;
    }
    .print-mode .card textarea::placeholder {
      color: transparent;
    }
    .print-mode .card textarea {
      color: var(--text);
    }
    .print-mode .card textarea[readonly] {
      background: transparent;
    }
    .print-mode .card textarea[readonly]::placeholder {
      color: transparent;
    }
    .print-mode .card textarea[readonly] {
      color: var(--text);
    }
    .print-mode .card textarea[readonly] {
      border: none;
    }
    .print-mode .card textarea[readonly] {
      resize: none;
    }
    .print-mode .card textarea[readonly] {
      outline: none;
    }
    .print-mode .card textarea[readonly] {
      font-family: inherit;
    }
    .print-mode .card textarea[readonly] {
      font-size: 1rem;
    }
    .print-mode .card textarea[readonly] {
      line-height: 1.5;
    }
    .print-mode .card textarea[readonly] {
      padding: 0;
    }
    .print-mode .card textarea[readonly] {
      margin: 0;
    }
    .print-mode .card textarea[readonly] {
      width: 100%;
    }
    .print-mode .card textarea[readonly] {
      min-height: auto;
    }
    .print-mode .card textarea[readonly] {
      background: transparent;
    }
    .print-mode .card textarea[readonly] {
      border: none;
    }
    .print-mode .card textarea[readonly] {
      outline: none;
    }
    .print-mode .card textarea[readonly] {
      font-family: inherit;
    }
    .print-mode .card textarea[readonly] {
      font-size: 1rem;
    }
    .print-mode .card textarea[readonly] {
      line-height: 1.5;
    }
    .print-mode .card textarea[readonly] {
      padding: 0;
    }
    .print-mode .card textarea[readonly] {
      margin: 0;
    }
    .print-mode .card textarea[readonly] {
      width: 100%;
    }
    .print-mode .card textarea[readonly] {
      min-height: auto;
    }
  </style>
</head>
<body>
  <h1>Daily Snapshot Planner</h1>
  <div class="controls">
    <input type="text" id="search" placeholder="Search tasks or tags..." />
    <button id="export">Export</button>
    <button id="import">Import</button>
    <button id="print">Print</button>
  </div>
  <div class="grid" id="planner"></div>
  <div class="print-mode" id="print-mode"></div>

  <script>
    // Data structure: { days: { 'YYYY-MM-DD': { cards: [ { text, completed } ] } } }
    let data = { days: {} };
    let lastOpenDay = null;

    // Load data from localStorage
    function loadData() {
      const saved = localStorage.getItem('daily-snapshot-planner');
      if (saved) {
        data = JSON.parse(saved);
      }
      lastOpenDay = localStorage.getItem('lastOpenDay');
    }

    // Save data to localStorage
    function saveData() {
      localStorage.setItem('daily-snapshot-planner', JSON.stringify(data));
      localStorage.setItem('lastOpenDay', lastOpenDay);
    }

    // Get current UTC date as YYYY-MM-DD
    function today() {
      const now = new Date();
      const utc = new Date(now.getTime() + now.getTimezoneOffset() * 60000);
      return utc.toISOString().split('T')[0];
    }

    // Get or create today's day section
    function getToday() {
      const date = today();
      if (!data.days[date]) {
        data.days[date] = { cards: [] };
      }
      return date;
    }

    // Render the planner
    function render() {
      const planner = document.getElementById('planner');
      planner.innerHTML = '';
      const search = document.getElementById('search').value.toLowerCase();
      const dates = Object.keys(data.days).sort().reverse();
      const current = getToday();

      // Always ensure today is present
      if (!dates.includes(current)) {
        dates.unshift(current);
      }

      dates.forEach(date => {
        const day = data.days[date];
        if (!day) return;

        const dayEl = document.createElement('div');
        dayEl.className = 'day';
        if (date === lastOpenDay || date === current) {
          dayEl.classList.add('expanded');
        }

        const header = document.createElement('div');
        header.className = 'day-header';
        header.innerHTML = `
          <span class="date">${date}</span>
          <span class="toggle">▼</span>
          <div class="actions">
            <button class="add-card">Add Card</button>
          </div>
        `;
        header.querySelector('.toggle').addEventListener('click', () => {
          dayEl.classList.toggle('expanded');
          lastOpenDay = dayEl.classList.contains('expanded') ? date : null;
          saveData();
        });
        header.querySelector('.add-card').addEventListener('click', () => {
          addCard(dayEl, date);
        });
        dayEl.appendChild(header);

        const content = document.createElement('div');
        content.className = 'day-content';
        day.cards.forEach((card, i) => {
          if (search && !card.text.toLowerCase().includes(search) && !extractTags(card.text).some(t => t.includes(search))) {
            return;
          }
          const cardEl = createCard(card, date, i);
          content.appendChild(cardEl);
        });
        dayEl.appendChild(content);
        planner.appendChild(dayEl);
      });
    }

    // Create a card element
    function createCard(card, date, index) {
      const cardEl = document.createElement('div');
      cardEl.className = 'card';
      if (card.completed) cardEl.classList.add('completed');

      const textarea = document.createElement('textarea');
      textarea.value = card.text;
      textarea.placeholder = 'Enter task or note...';
      textarea.addEventListener('input', () => {
        card.text = textarea.value;
        saveData();
        render();
      });
      cardEl.appendChild(textarea);

      const checkbox = document.createElement('div');
      checkbox.className = 'checkbox';
      checkbox.innerHTML = '<input type="checkbox" ' + (card.completed ? 'checked' : '') + '>';
      checkbox.querySelector('input').addEventListener('change', () => {
        card.completed = checkbox.querySelector('input').checked;
        cardEl.classList.toggle('completed', card.completed);
        saveData();
        render();
      });
      cardEl.appendChild(checkbox);

      const controls = document.createElement('div');
      controls.className = 'controls';
      controls.innerHTML = `
        <button class="up">↑</button>
        <button class="down">↓</button>
        <button class="delete">Delete</button>
      `;
      controls.querySelector('.up').addEventListener('click', () => {
        moveCard(date, index, -1);
      });
      controls.querySelector('.down').addEventListener('click', () => {
        moveCard(date, index, 1);
      });
      controls.querySelector('.delete').addEventListener('click', () => {
        data.days[date].cards.splice(index, 1);
        saveData();
        render();
      });
      cardEl.appendChild(controls);

      // Highlight tags
      highlightTags(textarea);

      return cardEl;
    }

    // Add a new card
    function addCard(dayEl, date) {
      data.days[date].cards.push({ text: '', completed: false });
      saveData();
      render();
      const cards = dayEl.querySelector('.day-content').children;
      if (cards.length > 0) {
        cards[cards.length - 1].querySelector('textarea').focus();
      }
    }

    // Move a card up or down
    function moveCard(date, index, dir) {
      const cards = data.days[date].cards;
      const newIndex = index + dir;
      if (newIndex < 0 || newIndex >= cards.length) return;
      [cards[index], cards[newIndex]] = [cards[newIndex], cards[index]];
      saveData();
      render();
    }

    // Extract tags from text
    function extractTags(text) {
      const regex = /#[\w-]+/g;
      return text.match(regex) || [];
    }

    // Highlight tags in textarea
    function highlightTags(textarea) {
      const tags = extractTags(textarea.value);
      let html = textarea.value;
      tags.forEach(tag => {
        const span = `<span class="tag">${tag}</span>`;
        html = html.replace(new RegExp(tag, 'g'), span);
      });
      textarea.innerHTML = html;
    }

    // Export data
    document.getElementById('export').addEventListener('click', () => {
      const blob = new Blob([JSON.stringify(data)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'daily-snapshot-planner.json';
      a.click();
    });

    // Import data
    document.getElementById('import').addEventListener('click', () => {
      const input = document.createElement('input');
      input.type = 'file';
      input.accept = 'application/json';
      input.onchange = e => {
        const file = e.target.files[0];
        const reader = new FileReader();
        reader.onload = () => {
          try {
            data = JSON.parse(reader.result);
            saveData();
            render();
          } catch (err) {
            alert('Invalid file');
          }
        };
        reader.readAsText(file);
      };
      input.click();
    });

    // Print mode
    document.getElementById('print').addEventListener('click', () => {
      const printMode = document.getElementById('print-mode');
      printMode.innerHTML = '';
      const dates = Object.keys(data.days).sort().reverse();
      dates.forEach(date => {
        const day = data.days[date];
        const dayEl = document.createElement('div');
        dayEl.className = 'day';
        const header = document.createElement('div');
        header.className = 'day-header';
        header.innerHTML = `<span class="date">${date}</span>`;
        dayEl.appendChild(header);
        const content = document.createElement('div');
        content.className = 'day-content';
        day.cards.forEach(card => {
          const cardEl = document.createElement('div');
          cardEl.className = 'card';
          if (card.completed) cardEl.classList.add('completed');
          const textarea = document.createElement('textarea');
          textarea.value = card.text;
          textarea.readOnly = true;
          cardEl.appendChild(textarea);
          content.appendChild(cardEl);
        });
        dayEl.appendChild(content);
        printMode.appendChild(dayEl);
      });
      window.print();
    });

    // Search
    document.getElementById('search').addEventListener('input', render);

    // Keyboard navigation
    document.addEventListener('keydown', e => {
      if (e.key === 'Enter' && e.target.tagName === 'TEXTAREA') {
        const dayEl = e.target.closest('.day');
        const date = dayEl.querySelector('.date').textContent;
        addCard(dayEl, date);
        e.preventDefault();
      } else if (e.key === ' ' && e.target.type === 'checkbox') {
        e.target.checked = !e.target.checked;
        e.target.dispatchEvent(new Event('change'));
        e.preventDefault();
      } else if (e.ctrlKey && e.key === 'ArrowUp') {
        const card = e.target.closest('.card');
        const day = card.closest('.day');
        const date = day.querySelector('.date').textContent;
        const index = Array.from(day.querySelectorAll('.card')).indexOf(card);
        moveCard(date, index, -1);
        e.preventDefault();
      } else if (e.ctrlKey && e.key === 'ArrowDown') {
        const card = e.target.closest('.card');
        const day = card.closest('.day');
        const date = day.querySelector('.date').textContent;
        const index = Array.from(day.querySelectorAll('.card')).indexOf(card);
        moveCard(date, index, 1);
        e.preventDefault();
      }
    });

    // Initialize
    loadData();
    render();
  </script>
</body>
</html>