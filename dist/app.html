<!DOCTYPE html>
<html lang="en">
<head>
<!-- Auto-generated via Perplexity on 2025-10-29T16:40:15.628887Z -->

<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Research Insight Hub</title>
<style>
  :root {
    --bg: #fff;
    --fg: #222;
    --accent: #0366d6;
    --accent-hover: #024ea2;
    --border: #ccc;
    --error: #b00020;
    --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen,
      Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
  }
  * {
    box-sizing: border-box;
  }
  body {
    margin: 0;
    font-family: var(--font-family);
    background: var(--bg);
    color: var(--fg);
    line-height: 1.5;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
  }
  header {
    background: var(--accent);
    color: #fff;
    padding: 1rem 1.5rem;
    font-weight: 600;
    font-size: 1.25rem;
    user-select: none;
  }
  main {
    flex: 1 1 auto;
    display: flex;
    flex-direction: row;
    min-height: 0;
  }
  nav {
    width: 240px;
    border-right: 1px solid var(--border);
    background: #f9f9f9;
    display: flex;
    flex-direction: column;
  }
  nav button {
    background: none;
    border: none;
    border-left: 4px solid transparent;
    padding: 1rem 1.25rem;
    text-align: left;
    font-size: 1rem;
    cursor: pointer;
    color: var(--fg);
    transition: background 0.15s, border-color 0.15s;
  }
  nav button[aria-selected="true"] {
    background: #e5f0ff;
    border-left-color: var(--accent);
    font-weight: 600;
  }
  nav button:focus-visible {
    outline-offset: -2px;
    outline: 2px solid var(--accent);
  }
  section {
    flex: 1 1 auto;
    padding: 1rem 1.5rem;
    overflow-y: auto;
    min-width: 0;
  }
  h2 {
    margin-top: 0;
    font-weight: 700;
    font-size: 1.5rem;
  }
  /* Research Notes */
  #notes {
    display: flex;
    flex-direction: column;
    height: 100%;
  }
  #notes-toolbar {
    margin-bottom: 0.5rem;
    display: flex;
    gap: 0.5rem;
  }
  #notes-toolbar button {
    background: var(--accent);
    border: none;
    color: #fff;
    padding: 0.25rem 0.6rem;
    font-size: 1rem;
    border-radius: 3px;
    cursor: pointer;
    user-select: none;
  }
  #notes-toolbar button:disabled {
    background: #a0c4ff;
    cursor: default;
  }
  #notes-toolbar button:focus-visible {
    outline-offset: 2px;
    outline: 2px solid #fff;
  }
  #notes-editor {
    flex: 1 1 auto;
    border: 1px solid var(--border);
    border-radius: 4px;
    padding: 0.5rem;
    font-family: var(--font-family);
    font-size: 1rem;
    overflow-y: auto;
    min-height: 150px;
  }
  #notes-editor:focus {
    outline: 2px solid var(--accent);
  }
  /* Reference List */
  #references-list {
    margin: 0;
    padding: 0;
    list-style: none;
    max-height: 60vh;
    overflow-y: auto;
    border: 1px solid var(--border);
    border-radius: 4px;
  }
  #references-list li {
    display: flex;
    flex-direction: column;
    border-bottom: 1px solid var(--border);
    padding: 0.5rem 0.75rem;
  }
  #references-list li:last-child {
    border-bottom: none;
  }
  #references-list label {
    font-weight: 600;
    font-size: 0.9rem;
    margin-top: 0.25rem;
  }
  #references-list input[type="text"],
  #references-list input[type="url"],
  #references-list input[type="number"] {
    width: 100%;
    padding: 0.25rem 0.4rem;
    font-size: 1rem;
    border: 1px solid var(--border);
    border-radius: 3px;
  }
  #references-list input:focus {
    outline: 2px solid var(--accent);
  }
  #references-controls {
    margin: 0.5rem 0 1rem 0;
    display: flex;
    gap: 0.5rem;
  }
  #references-controls button {
    background: var(--accent);
    border: none;
    color: #fff;
    padding: 0.35rem 0.8rem;
    font-size: 1rem;
    border-radius: 3px;
    cursor: pointer;
    user-select: none;
  }
  #references-controls button:disabled {
    background: #a0c4ff;
    cursor: default;
  }
  #references-controls button:focus-visible {
    outline-offset: 2px;
    outline: 2px solid #fff;
  }
  /* Key Insights */
  #insights-list {
    margin: 0;
    padding-left: 1.25rem;
    max-height: 60vh;
    overflow-y: auto;
    border: 1px solid var(--border);
    border-radius: 4px;
  }
  #insights-list li {
    margin-bottom: 0.5rem;
    font-size: 1rem;
    line-height: 1.3;
  }
  #insights-controls {
    margin: 0.5rem 0 1rem 0;
    display: flex;
    gap: 0.5rem;
  }
  #insights-controls button {
    background: var(--accent);
    border: none;
    color: #fff;
    padding: 0.35rem 0.8rem;
    font-size: 1rem;
    border-radius: 3px;
    cursor: pointer;
    user-select: none;
  }
  #insights-controls button:disabled {
    background: #a0c4ff;
    cursor: default;
  }
  #insights-controls button:focus-visible {
    outline-offset: 2px;
    outline: 2px solid #fff;
  }
  #insight-input {
    width: 100%;
    font-size: 1rem;
    padding: 0.3rem 0.5rem;
    border: 1px solid var(--border);
    border-radius: 3px;
  }
  #insight-input:focus {
    outline: 2px solid var(--accent);
  }
  /* Export/Import & Print Controls */
  #global-controls {
    background: #f5f5f5;
    border-top: 1px solid var(--border);
    padding: 0.5rem 1rem;
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    justify-content: center;
  }
  #global-controls button {
    background: var(--accent);
    border: none;
    color: #fff;
    padding: 0.4rem 0.9rem;
    font-size: 1rem;
    border-radius: 3px;
    cursor: pointer;
    user-select: none;
  }
  #global-controls button:focus-visible {
    outline-offset: 2px;
    outline: 2px solid #fff;
  }
  #global-controls input[type="file"] {
    display: none;
  }
  #error-message {
    color: var(--error);
    font-weight: 600;
    margin-top: 0.25rem;
    min-height: 1.2em;
    text-align: center;
  }
  /* Responsive */
  @media (max-width: 720px) {
    main {
      flex-direction: column;
    }
    nav {
      width: 100%;
      border-right: none;
      border-bottom: 1px solid var(--border);
      flex-direction: row;
      overflow-x: auto;
    }
    nav button {
      flex: 1 1 auto;
      text-align: center;
      border-left: none;
      border-bottom: 4px solid transparent;
      padding: 0.75rem 0.5rem;
      font-size: 0.9rem;
      white-space: nowrap;
    }
    nav button[aria-selected="true"] {
      border-left: none;
      border-bottom-color: var(--accent);
    }
    section {
      padding: 1rem 1rem;
    }
  }
  /* Print styles */
  @media print {
    body {
      background: #fff;
      color: #000;
    }
    header, nav, #global-controls, #error-message {
      display: none !important;
    }
    main {
      flex-direction: column;
    }
    section {
      padding: 0;
      margin-bottom: 1.5rem;
      border: none !important;
      overflow: visible !important;
      max-height: none !important;
    }
    #notes-editor {
      border: none !important;
      box-shadow: none !important;
      padding: 0 !important;
      min-height: auto !important;
    }
    #references-list li {
      border: none !important;
      padding: 0.1rem 0 !important;
    }
    #insights-list {
      padding-left: 1.5rem !important;
      border: none !important;
    }
  }
</style>
</head>
<body>
<header id="app-title" role="banner">Research Insight Hub</header>
<nav role="tablist" aria-label="Research sections">
  <button role="tab" id="tab-notes" aria-selected="true" aria-controls="panel-notes" tabindex="0">Research Notes</button>
  <button role="tab" id="tab-references" aria-selected="false" aria-controls="panel-references" tabindex="-1">Reference List</button>
  <button role="tab" id="tab-insights" aria-selected="false" aria-controls="panel-insights" tabindex="-1">Key Insights</button>
</nav>
<main>
  <section id="panel-notes" role="tabpanel" tabindex="0" aria-labelledby="tab-notes">
    <h2>Research Notes</h2>
    <div id="notes" aria-label="Research notes editor">
      <div id="notes-toolbar" role="toolbar" aria-label="Text formatting controls">
        <button type="button" data-command="bold" aria-label="Bold (Ctrl+B)" title="Bold (Ctrl+B)"><b>B</b></button>
        <button type="button" data-command="italic" aria-label="Italic (Ctrl+I)" title="Italic (Ctrl+I)"><i>I</i></button>
        <button type="button" data-command="underline" aria-label="Underline (Ctrl+U)" title="Underline (Ctrl+U)"><u>U</u></button>
        <button type="button" data-command="insertUnorderedList" aria-label="Bullet list" title="Bullet list">&bull; List</button>
        <button type="button" data-command="insertOrderedList" aria-label="Numbered list" title="Numbered list">1. List</button>
      </div>
      <div id="notes-editor" contenteditable="true" aria-multiline="true" role="textbox" aria-label="Research notes text editor" spellcheck="true"></div>
    </div>
  </section>
  <section id="panel-references" role="tabpanel" tabindex="-1" aria-labelledby="tab-references" hidden>
    <h2>Reference List</h2>
    <ul id="references-list" aria-live="polite" aria-label="List of references"></ul>
    <div id="references-controls">
      <button type="button" id="add-reference" aria-label="Add new reference">Add Reference</button>
      <button type="button" id="remove-reference" aria-label="Remove last reference" disabled>Remove Last</button>
    </div>
  </section>
  <section id="panel-insights" role="tabpanel" tabindex="-1" aria-labelledby="tab-insights" hidden>
    <h2>Key Insights</h2>
    <ul id="insights-list" aria-live="polite" aria-label="List of key insights"></ul>
    <div id="insights-controls">
      <input type="text" id="insight-input" aria-label="New insight input" placeholder="Add new insight" />
      <button type="button" id="add-insight" aria-label="Add insight">Add</button>
      <button type="button" id="remove-insight" aria-label="Remove last insight" disabled>Remove Last</button>
    </div>
  </section>
</main>
<div id="global-controls" role="region" aria-label="Global application controls">
  <button type="button" id="export-json" aria-label="Export research data as JSON">Export JSON</button>
  <button type="button" id="import-json-btn" aria-label="Import research data from JSON file">Import JSON</button>
  <input type="file" id="import-json-file" accept="application/json" aria-hidden="true" tabindex="-1" />
  <button type="button" id="toggle-print" aria-label="Toggle print-friendly view">Print View</button>
</div>
<div id="error-message" role="alert" aria-live="assertive"></div>
<script>
(() => {
  "use strict";

  // Elements
  const tabs = [...document.querySelectorAll('nav[role="tablist"] button[role="tab"]')];
  const panels = tabs.map(t => document.getElementById(t.getAttribute('aria-controls')));
  const notesEditor = document.getElementById('notes-editor');
  const notesToolbar = document.getElementById('notes-toolbar');
  const referencesList = document.getElementById('references-list');
  const addReferenceBtn = document.getElementById('add-reference');
  const removeReferenceBtn = document.getElementById('remove-reference');
  const insightsList = document.getElementById('insights-list');
  const insightInput = document.getElementById('insight-input');
  const addInsightBtn = document.getElementById('add-insight');
  const removeInsightBtn = document.getElementById('remove-insight');
  const exportBtn = document.getElementById('export-json');
  const importBtn = document.getElementById('import-json-btn');
  const importFileInput = document.getElementById('import-json-file');
  const togglePrintBtn = document.getElementById('toggle-print');
  const errorMessage = document.getElementById('error-message');
  const body = document.body;

  // State keys
  const STORAGE_KEY = 'researchInsightHubData';

  // Current tab index
  let currentTabIndex = 0;
  // Print mode flag
  let printMode = false;

  // Utility: sanitize text for HTML insertion (basic)
  function escapeHTML(str) {
    return str.replace(/[&<>"']/g, s => {
      switch (s) {
        case '&': return '&amp;';
        case '<': return '&lt;';
        case '>': return '&gt;';
        case '"': return '&quot;';
        case "'": return '&#39;';
        default: return s;
      }
    });
  }

  // --- Tab switching ---
  function activateTab(index, focusPanel = true) {
    if (index < 0 || index >= tabs.length) return;
    tabs.forEach((tab, i) => {
      const selected = i === index;
      tab.setAttribute('aria-selected', selected ? 'true' : 'false');
      tab.tabIndex = selected ? 0 : -1;
      panels[i].hidden = !selected;
      panels[i].tabIndex = selected ? 0 : -1;
    });
    currentTabIndex = index;
    if (focusPanel) panels[index].focus();
  }

  // Keyboard navigation for tabs
  function onTabKeydown(e) {
    const idx = tabs.indexOf(e.target);
    if (idx === -1) return;
    switch (e.key) {
      case 'ArrowRight':
      case 'ArrowDown':
        e.preventDefault();
        activateTab((idx + 1) % tabs.length);
        tabs[(idx + 1) % tabs.length].focus();
        break;
      case 'ArrowLeft':
      case 'ArrowUp':
        e.preventDefault();
        activateTab((idx - 1 + tabs.length) % tabs.length);
        tabs[(idx - 1 + tabs.length) % tabs.length].focus();
        break;
      case 'Home':
        e.preventDefault();
        activateTab(0);
        tabs.focus();
        break;
      case 'End':
        e.preventDefault();
        activateTab(tabs.length - 1);
        tabs[tabs.length - 1].focus();
        break;
    }
  }

  // --- Notes toolbar commands ---
  function execCommand(command) {
    document.execCommand(command, false, null);
    notesEditor.focus();
    saveStateDebounced();
  }

  // --- References management ---
  // Create a reference entry element
  function createReferenceEntry(data = {}) {
    const li = document.createElement('li');
    li.tabIndex = -1;

    const fields = [
      { label: 'Title', type: 'text', name: 'title', required: true },
      { label: 'Author', type: 'text', name: 'author' },
      { label: 'Year', type: 'number', name: 'year', min: 0, max: 9999 },
      { label: 'URL', type: 'url', name: 'url' }
    ];

    fields.forEach(({ label, type, name, required, min, max }) => {
      const lbl = document.createElement('label');
      lbl.textContent = label;
      lbl.htmlFor = `ref-${name}-${Date.now()}-${Math.random().toString(36).slice(2)}`;
      const input = document.createElement('input');
      input.type = type;
      input.name = name;
      input.id = lbl.htmlFor;
      if (required) input.required = true;
      if (min !== undefined) input.min = min;
      if (max !== undefined) input.max = max;
      input.value = data[name] || '';
      input.autocomplete = 'off';
      input.spellcheck = false;
      input.addEventListener('input', saveStateDebounced);
      lbl.appendChild(input);
      li.appendChild(lbl);
    });
    return li;
  }

  function addReference(data) {
    const entry = createReferenceEntry(data);
    referencesList.appendChild(entry);
    removeReferenceBtn.disabled = false;
    saveStateDebounced();
  }

  function removeLastReference() {
    if (referencesList.lastElementChild) {
      referencesList.removeChild(referencesList.lastElementChild);
      if (!referencesList.lastElementChild) removeReferenceBtn.disabled = true;
      saveStateDebounced();
    }
  }

  // --- Insights management ---
  function addInsight(text) {
    if (!text.trim()) return;
    const li = document.createElement('li');
    li.textContent = text.trim();
    insightsList.appendChild(li);
    removeInsightBtn.disabled = false;
    insightInput.value = '';
    insightInput.focus();
    saveStateDebounced();
  }

  function removeLastInsight() {
    if (insightsList.lastElementChild) {
      insightsList.removeChild(insightsList.lastElementChild);
      if (!insightsList.lastElementChild) removeInsightBtn.disabled = true;
      saveStateDebounced();
    }
  }

  // --- Data persistence and serialization ---
  // Gather current app data
  function gatherData() {
    // Notes: innerHTML of notesEditor
    const notes = notesEditor.innerHTML;

    // References: array of objects
    const references = [];
    for (const li of referencesList.children) {
      const obj = {};
      const inputs = li.querySelectorAll('input');
      inputs.forEach(input => {
        obj[input.name] = input.value.trim();
      });
      references.push(obj);
    }

    // Insights: array of strings
    const insights = [];
    for (const li of insightsList.children) {
      insights.push(li.textContent.trim());
    }

    return { notes, references, insights };
  }

  // Load data into UI
  function loadData(data) {
    if (!data || typeof data !== 'object') return;
    // Notes
    if (typeof data.notes === 'string') {
      notesEditor.innerHTML = data.notes;
    } else {
      notesEditor.innerHTML = '';
    }
    // References
    referencesList.innerHTML = '';
    if (Array.isArray(data.references)) {
      data.references.forEach(ref => addReference(ref));
    }
    removeReferenceBtn.disabled = referencesList.children.length === 0;
    // Insights
    insightsList.innerHTML = '';
    if (Array.isArray(data.insights)) {
      data.insights.forEach(text => addInsight(text));
    }
    removeInsightBtn.disabled = insightsList.children.length === 0;
  }

  // Save state to localStorage and update URL hash
  function saveState() {
    const data = gatherData();
    try {
      const json = JSON.stringify(data);
      localStorage.setItem(STORAGE_KEY, json);
      // Encode to base64 for URL hash (URI safe)
      const encoded = btoa(encodeURIComponent(json));
      location.hash = encoded;
      errorMessage.textContent = '';
    } catch (e) {
      errorMessage.textContent = 'Error saving data: ' + e.message;
    }
  }
  const saveStateDebounced = debounce(saveState, 500);

  // Load state from localStorage or URL hash
  function loadState() {
    // Try URL hash first
    if (location.hash.length > 1) {
      try {
        const decoded = decodeURIComponent(atob(location.hash.slice(1)));
        const data = JSON.parse(decoded);
        loadData(data);
        errorMessage.textContent = '';
        return;
      } catch (e) {
        errorMessage.textContent = 'Error parsing URL data: ' + e.message;
      }
    }
    // Fallback localStorage
    try {
      const json = localStorage.getItem(STORAGE_KEY);
      if (json) {
        const data = JSON.parse(json);
        loadData(data);
        errorMessage.textContent = '';
      }
    } catch (e) {
      errorMessage.textContent = 'Error loading saved data: ' + e.message;
    }
  }

  // --- Export and Import ---
  function exportJSON() {
    const data = gatherData();
    try {
      const json = JSON.stringify(data, null, 2);
      const blob = new Blob([json], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'research_insight_hub_data.json';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
      errorMessage.textContent = '';
    } catch (e) {
      errorMessage.textContent = 'Export failed: ' + e.message;
    }
  }

  function importJSON(file) {
    if (!file) return;
    const reader = new FileReader();
    reader.onload = e => {
      try {
        const text = e.target.result;
        const data = JSON.parse(text);
        loadData(data);
        saveState();
        errorMessage.textContent = '';
      } catch (err) {
        errorMessage.textContent = 'Import failed: Invalid JSON file.';
      }
    };
    reader.onerror = () => {
      errorMessage.textContent = 'Import failed: Unable to read file.';
    };
    reader.readAsText(file);
  }

  // --- Print view toggle ---
  function togglePrintView() {
    printMode = !printMode;
    if (printMode) {
      body.classList.add('print-view');
      togglePrintBtn.textContent = 'Exit Print View';
      // Focus main content for keyboard users
      panels[currentTabIndex].focus();
    } else {
      body.classList.remove('print-view');
      togglePrintBtn.textContent = 'Print View';
    }
  }

  // --- Keyboard shortcuts ---
  function onGlobalKeydown(e) {
    if (e.defaultPrevented) return;
    const ctrl = e.ctrlKey || e.metaKey;
    if (!ctrl) return;
    switch (e.key.toLowerCase()) {
      case 'b':
        if (currentTabIndex === 0) {
          e.preventDefault();
          execCommand('bold');
        }
        break;
      case 'i':
        if (currentTabIndex === 0) {
          e.preventDefault();
          execCommand('italic');
        }
        break;
      case 'u':
        if (currentTabIndex === 0) {
          e.preventDefault();
          execCommand('underline');
        }
        break;
      case 'n':
        e.preventDefault();
        if (currentTabIndex === 0) {
          // Add new note: focus notes editor
          notesEditor.focus();
        } else if (currentTabIndex === 1) {
          addReference();
          // Focus last reference title input
          const lastRef = referencesList.lastElementChild;
          if (lastRef) {
            const input = lastRef.querySelector('input[name="title"]');
            if (input) input.focus();
          }
        } else if (currentTabIndex === 2) {
          insightInput.focus();
        }
        break;
      case 'e':
        e.preventDefault();
        exportJSON();
        break;
      case 'o':
        e.preventDefault();
        importFileInput.click();
        break;
      case 'p':
        e.preventDefault();
        togglePrintView();
        break;
    }
  }

  // --- Debounce utility ---
  function debounce(fn, delay) {
    let timer = null;
    return function (...args) {
      clearTimeout(timer);
      timer = setTimeout(() => fn.apply(this, args), delay);
    };
  }

  // --- Initialization ---
  function init() {
    // Load saved state or URL hash
    loadState();

    // Activate default tab
    activateTab(0, false);

    // Tab click handlers
    tabs.forEach((tab, i) => {
      tab.addEventListener('click', () => activateTab(i));
      tab.addEventListener('keydown', onTabKeydown);
    });

    // Notes toolbar buttons
    notesToolbar.addEventListener('click', e => {
      if (e.target.closest('button')) {
        const btn = e.target.closest('button');
        const cmd = btn.dataset.command;
        if (cmd) execCommand(cmd);
      }
    });

    // Notes editor input saves state
    notesEditor.addEventListener('input', saveStateDebounced);

    // References buttons
    addReferenceBtn.addEventListener('click', () => {
      addReference();
      // Focus last reference title input
      const lastRef = referencesList.lastElementChild;
      if (lastRef) {
        const input = lastRef.querySelector('input[name="title"]');
        if (input) input.focus();
      }
    });
    removeReferenceBtn.addEventListener('click', () => {
      removeLastReference();
    });

    // Insights buttons
    addInsightBtn.addEventListener('click', () => {
      addInsight(insightInput.value);
    });
    removeInsightBtn.addEventListener('click', () => {
      removeLastInsight();
    });
    insightInput.addEventListener('keydown', e => {
      if (e.key === 'Enter') {
        e.preventDefault();
        addInsight(insightInput.value);
      }
    });

    // Export/Import buttons
    exportBtn.addEventListener('click', exportJSON);
    importBtn.addEventListener('click', () => importFileInput.click());
    importFileInput.addEventListener('change', e => {
      if (e.target.files.length > 0) {
        importJSON(e.target.files);
        e.target.value = '';
      }
    });

    // Print view toggle
    togglePrintBtn.addEventListener('click', togglePrintView);

    // Keyboard shortcuts
    window.addEventListener('keydown', onGlobalKeydown);

    // Save on unload
    window.addEventListener('beforeunload', saveState);

    // Accessibility: focus outlines visible only on keyboard navigation
    function handleFirstTab(e) {
      if (e.key === 'Tab') {
        document.body.classList.add('user-is-tabbing');
        window.removeEventListener('keydown', handleFirstTab);
      }
    }
    window.addEventListener('keydown', handleFirstTab);
  }

  // Run init on DOM ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', init);
  } else {
    init();
  }
})();
</script>
</body>
</html>